# NBA Player Prediction Configuration
# All project parameters in one place

# Data Collection
data:
  seasons:
    - "2019-20"
    - "2020-21"
    - "2021-22"
    - "2022-23"
    - "2023-24"

  n_players: 200  # Top N players by minutes played

  api:
    rate_limit_seconds: 0.6  # ~1 request per second
    timeout_seconds: 30
    max_retries: 3

  paths:
    raw: "data/raw"
    processed: "data/processed"
    cache: "data/cache"

# Feature Engineering
features:
  # Rolling window sizes
  rolling_windows: [3, 5, 10]

  # Stats to create rolling features for
  rolling_stats:
    - PTS
    - REB
    - AST
    - MIN
    - FGA
    - FG_PCT
    - FG3A
    - FG3_PCT
    - FTA
    - FT_PCT

  # Advanced features (Phase 3)
  advanced:
    enable_shot_locations: true
    enable_efficiency_metrics: true
    enable_matchup_history: true
    enable_trend_indicators: true

  # Leakage prevention
  shift_periods: 1  # Always shift by 1 before rolling

# Train/Validation/Test Splits
splits:
  # Temporal splits (never shuffle!)
  train_end_date: "2024-01-01"
  val_end_date: "2024-07-01"
  # Test is everything after val_end_date

  # Minimum games for player inclusion
  min_games_played: 10

# Model Configuration
models:
  random_seed: 42

  # Baseline
  baseline:
    type: "rolling_average"
    window: 5

  # Models for each target
  pts:
    primary_models:
      - name: "lasso"
        params:
          alpha: 0.1
          max_iter: 10000

      - name: "xgboost"
        params:
          n_estimators: 200
          max_depth: 5
          learning_rate: 0.03
          subsample: 0.8
          colsample_bytree: 0.8
          random_state: 42

      - name: "lightgbm"
        params:
          n_estimators: 200
          max_depth: 5
          learning_rate: 0.03
          subsample: 0.8
          colsample_bytree: 0.8
          random_state: 42

    # Ensemble weights
    ensemble:
      lasso: 0.3
      xgboost: 0.35
      lightgbm: 0.35

  reb:
    primary_model: "xgboost"
    params:
      n_estimators: 100
      max_depth: 3
      learning_rate: 0.05
      subsample: 0.8
      random_state: 42

  ast:
    primary_model: "xgboost"
    params:
      n_estimators: 100
      max_depth: 3
      learning_rate: 0.05
      subsample: 0.8
      random_state: 42

  # Hyperparameter search (optional)
  hyperparameter_search:
    enable: false  # Set true for grid search
    cv_splits: 5
    scoring: "neg_mean_absolute_error"

# Evaluation
evaluation:
  metrics:
    - MAE  # Primary metric
    - RMSE
    - R2
    - MAPE

  # Analysis slices
  slices:
    - name: "overall"
      description: "All test games"

    - name: "top_20_players"
      description: "Top 20 by minutes in test period"

    - name: "by_position"
      description: "Guard vs Forward vs Center"

    - name: "by_rest"
      description: "0, 1, 2, 3+ rest days"

    - name: "home_away"
      description: "Home vs Away games"

  # Bootstrap confidence intervals
  bootstrap:
    n_iterations: 1000
    confidence_level: 0.95

# Visualization
visualization:
  style: "seaborn"
  figure_size: [10, 6]
  dpi: 300

  plots:
    # Exploration
    - distribution_plots
    - correlation_heatmap
    - time_series_trends

    # Model performance
    - predictions_vs_actual
    - error_distribution
    - feature_importance
    - residual_analysis

  # Interactive dashboard
  dashboard:
    enable: true  # Set false to skip
    port: 8501  # Streamlit default

# Testing
testing:
  coverage_threshold: 80  # Minimum code coverage %

  test_data:
    n_games: 1000  # Size of test dataset for unit tests
    n_players: 10

# Logging
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "nba_predictions.log"

# Output
output:
  models_dir: "models"
  results_dir: "results"

  save_models: true
  save_predictions: true
  save_metrics: true

  # Artifact naming
  timestamp_format: "%Y%m%d_%H%M%S"

# Goals (from GOALS.md)
goals:
  tier1:  # Must achieve
    pts: 5.09
    reb: 1.97
    ast: 1.51

  tier2:  # Target
    pts: 4.50
    reb: 2.00
    ast: 1.50

  tier3:  # Stretch
    pts: 3.80
    reb: 1.80
    ast: 1.30
